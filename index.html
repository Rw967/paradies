<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>Paradies.io - V44 FINAL STABLE</title>
    <style>
        :root { --neon: #00f7ff; --gold: #ffd700; --bg: #020205; --win: #00ff88; --red: #ff4d4d; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; overflow: hidden; user-select: none; }
        #bgCanvas { position: fixed; inset: 0; z-index: -1; filter: brightness(2); }

        .overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 1000; display: none; flex-direction: column; justify-content: center; align-items: center; }
        .window { background: #0a0a15; border: 3px solid var(--neon); padding: 30px; border-radius: 20px; text-align: center; width: 90%; max-width: 600px; box-shadow: 0 0 60px rgba(0,247,255,0.4); }
        
        .btn { background: transparent; border: 2px solid var(--neon); color: var(--neon); padding: 12px 25px; cursor: pointer; border-radius: 8px; font-weight: bold; text-transform: uppercase; transition: 0.2s; margin: 5px; }
        .btn:hover { background: var(--neon); color: #000; box-shadow: 0 0 20px var(--neon); }
        .btn-gold { border-color: var(--gold); color: var(--gold); }

        #skinList { display: grid; grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); gap: 10px; padding: 10px; }
        .skin-card { background: rgba(255,255,255,0.05); border: 1px solid #333; border-radius: 8px; padding: 10px; cursor: pointer; text-align: center; }
        .equipped { border-color: var(--win); background: rgba(0,255,136,0.1); }

        #welt { width: 1000px; height: 600px; background: rgba(0,0,0,0.96); border: 4px solid #333; margin: 70px auto; position: relative; overflow: hidden; display: none; }
        #player { position: absolute; z-index: 20; display: flex; align-items: center; justify-content: center; }
        .apple { position: absolute; width: 22px; height: 22px; background: #ff0000; border-radius: 50%; box-shadow: 0 0 20px #ff0000; }
        .enemy { position: absolute; border: 2px solid red; border-radius: 8px; font-size: 25px; display: flex; align-items: center; justify-content: center; box-shadow: 0 0 15px red; }
        .bullet { position: absolute; background: var(--gold); width: 10px; height: 10px; border-radius: 50%; }
        .blackhole { position: absolute; width: 120px; height: 120px; background: radial-gradient(circle, #000 40%, var(--red) 100%); border-radius: 50%; left: 440px; top: 240px; box-shadow: 0 0 50px var(--red); }
        
        #hud { position: absolute; top: 0; width: 100%; height: 65px; display: none; justify-content: space-around; align-items: center; background: #000; border-bottom: 3px solid var(--neon); z-index: 100; font-size: 20px; font-weight: bold; }
    </style>
</head>
<body oncontextmenu="return false;">

<canvas id="bgCanvas"></canvas>

<div id="mainMenu" class="overlay" style="display: flex;">
    <h1 style="color: var(--neon); font-size: 80px; text-shadow: 0 0 30px var(--neon); margin: 0;">PARADIES.IO</h1>
    <div style="color: var(--gold); font-size: 25px; margin: 15px 0;">COINS: <span id="bankDisplay">0</span> ü™ô</div>
    <div style="display: flex; gap: 10px;">
        <button class="btn" onclick="toggleMenu('modeMenu', true)">MISSIONEN</button>
        <button class="btn btn-gold" onclick="toggleMenu('shopMenu', true)">SHOP</button>
        <button class="btn" style="border-color:#555; color:#555;" onclick="toggleMenu('settingsMenu', true)">SETTINGS</button>
    </div>
    <button class="btn" style="position: fixed; bottom: 20px; right: 20px; border-color: red; color: red;" onclick="toggleMenu('confirmDelete', true)">KONTO L√ñSCHEN</button>
</div>

<div id="modeMenu" class="overlay">
    <div class="window">
        <h2 style="color: var(--neon);">MISSION W√ÑHLEN</h2>
        <div id="modeButtons" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;"></div>
        <div id="briefingBox" style="display:none; margin-top:20px; padding:15px; border:2px solid var(--gold); background:rgba(255,215,0,0.05);">
            <h3 id="bTitle" style="color:var(--gold); margin:0;"></h3>
            <p id="bDesc" style="font-size:14px; color:#ccc;"></p>
            <button class="btn" id="startBtn" style="width:100%; background:var(--win); color:black;">MISSION STARTEN</button>
        </div>
        <button class="btn" onclick="toggleMenu('mainMenu', true)" style="margin-top:10px;">ZUR√úCK</button>
    </div>
</div>

<div id="shopMenu" class="overlay"><div class="window"><h2>SKIN SHOP</h2><div id="skinList"></div><button class="btn" onclick="toggleMenu('mainMenu', true)">ZUR√úCK</button></div></div>
<div id="settingsMenu" class="overlay"><div class="window"><h2>SETTINGS</h2><p>MUSIC: <input type="range"></p><p>SFX: <input type="range"></p><button class="btn" onclick="toggleMenu('mainMenu', true)">OK</button></div></div>
<div id="confirmDelete" class="overlay"><div class="window"><h2>L√ñSCHEN?</h2><button class="btn" onclick="localStorage.clear(); location.reload();">JA</button><button class="btn" onclick="toggleMenu('mainMenu', true)">NEIN</button></div></div>
<div id="completeMenu" class="overlay"><div class="window"><h2 id="finishTitle">ENDE</h2><p style="font-size:30px;">BELOHNUNG: <span id="finishCoins">0</span> ü™ô</p><button class="btn" onclick="location.reload()">HAUPTMEN√ú</button></div></div>

<div id="hud">
    <div id="hud-mode">MODE</div>
    <div id="hud-lives">‚ù§Ô∏è 3</div>
    <div id="hud-coins">ü™ô 0</div>
    <div id="hud-timer"></div>
    <button class="btn" style="font-size:12px;" onclick="finishLevel()">SICHERN</button>
</div>

<div id="welt"><div id="player"></div></div>

<script>
let bank = parseInt(localStorage.getItem('p_bank')) || 0;
let ownedSkins = JSON.parse(localStorage.getItem('p_skins')) || ['üü¶'];
let currentSkin = localStorage.getItem('p_currentSkin') || 'üü¶';
let x, y, lives, sessionCoins, score, pSize, isAlive = false, timeLeft = 60, gameTime = 0;
let keys = {}, currentMode = '', bullets = [], enemies = [];

const modes = {
    'Kampf': 'Zerst√∂re die üëæ Gegner! Nur Kills geben Coins (3 pro Kill).',
    'Gigant': 'Werde 450px gro√ü durch √Ñpfel. W√§nde sind kein Problem!',
    'Coin Simulator': 'Jeder 2. Apfel gibt dir einen Coin. Ganz entspannt.',
    'Hardcore': 'EXTREME SPEED! Du hast nur 1 Leben. Wer lange √ºberlebt, kriegt den Bonus.',
    'Klassik': '60 Sekunden Zeit. Sammle so viele √Ñpfel wie m√∂glich!',
    'Coin-Farming': 'Vorsicht vor dem roten Loch in der Mitte! Viele √Ñpfel = Viele Coins.'
};

const skinIcons = ['üü¶','üê±','üòé','üëΩ','ü§ñ','ü¶ä','ü¶Å','üíé','üî•','üëë','üêô','üê°','üê¢','ü¶ñ','üöÄ','üõ∏','üåà','üçï','üéÆ','üëæ','üíÄ','üí∞','üßø','üåÄ','üë∫','üëª','ü§°','üëπ','üåü','üåô','üåç','üé®','üé¨','üé§','üéß','üé∏','üïπÔ∏è','ü™ê','üß™','üß¨','üîã','‚ö°','üîã','üíé','üõ∏'];

function toggleMenu(id, s) { 
    document.querySelectorAll('.overlay').forEach(o => o.style.display = 'none');
    if(s) document.getElementById(id).style.display = 'flex';
    if(id==='shopMenu') renderShop();
}

function renderShop() {
    const list = document.getElementById('skinList'); list.innerHTML = '';
    skinIcons.forEach((s, i) => {
        const price = i * 50; const isOwned = ownedSkins.includes(s);
        const card = document.createElement('div'); card.className = `skin-card ${currentSkin === s ? 'equipped' : ''}`;
        card.innerHTML = `<div style="font-size:25px">${s}</div><div style="font-size:9px">${isOwned?'FREI':price}</div>`;
        card.onclick = () => {
            if(isOwned) { currentSkin = s; localStorage.setItem('p_currentSkin', s); renderShop(); }
            else if(bank >= price) { bank -= price; ownedSkins.push(s); localStorage.setItem('p_bank', bank); localStorage.setItem('p_skins', JSON.stringify(ownedSkins)); renderShop(); }
        };
        list.appendChild(card);
    });
}

const mBox = document.getElementById('modeButtons');
Object.keys(modes).forEach(m => {
    const b = document.createElement('button'); b.className = 'btn'; b.innerText = m;
    b.onclick = () => {
        document.getElementById('briefingBox').style.display = 'block';
        document.getElementById('bTitle').innerText = m;
        document.getElementById('bDesc').innerText = modes[m];
        document.getElementById('startBtn').onclick = () => startGame(m);
    };
    mBox.appendChild(b);
});

function startGame(m) {
    currentMode = m; isAlive = true; score = 0; sessionCoins = 0; pSize = 35; gameTime = 0;
    x = (m === 'Coin-Farming') ? 100 : 480; y = 280; // Startpunkt Fix f√ºr Farming
    lives = (m === 'Hardcore') ? 1 : 3;
    timeLeft = 60; bullets = []; enemies = [];
    toggleMenu('', false);
    document.getElementById('hud').style.display = 'flex';
    document.getElementById('welt').style.display = 'block';
    document.getElementById('welt').innerHTML = '<div id="player"></div>';
    if(m === 'Coin-Farming') { let bh = document.createElement('div'); bh.className = 'blackhole'; document.getElementById('welt').appendChild(bh); }
    if(m === 'Kampf') spawnEnemy();
    spawnApple(); loop();
}

function spawnApple() {
    const a = document.createElement('div'); a.className = 'apple';
    a.style.left = Math.random()*950+'px'; a.style.top = Math.random()*550+'px';
    document.getElementById('welt').appendChild(a);
}

function spawnEnemy() {
    const e = document.createElement('div'); e.className = 'enemy'; e.innerHTML = 'üëæ';
    e.style.left = Math.random()*900+'px'; e.style.top = Math.random()*500+'px';
    e.style.width = '50px'; e.style.height = '50px';
    document.getElementById('welt').appendChild(e);
    enemies.push({el: e});
}

function loop() {
    if(!isAlive) return;
    gameTime += 0.016;
    let s = (currentMode === 'Hardcore') ? 25 : 10;
    if(keys['KeyW']) y -= s; if(keys['KeyS']) y += s;
    if(keys['KeyA']) x -= s; if(keys['KeyD']) x += s;

    // Border Logic
    if(x<0 || x>1000-pSize || y<0 || y>600-pSize) {
        if(currentMode === 'Hardcore') { die(); return; }
        x = Math.max(0, Math.min(x, 1000-pSize)); y = Math.max(0, Math.min(y, 600-pSize));
    }

    // Apples
    document.querySelectorAll('.apple').forEach(a => {
        if(Math.abs(x-parseInt(a.style.left))<pSize && Math.abs(y-parseInt(a.style.top))<pSize) {
            a.remove(); spawnApple(); score++;
            if(currentMode === 'Coin Simulator' && score % 2 === 0) sessionCoins++;
            if(currentMode === 'Klassik' || currentMode === 'Coin-Farming' || currentMode === 'Hardcore') sessionCoins++;
            if(currentMode === 'Gigant') { pSize += 12; if(pSize >= 450) finishLevel(); }
            updateHUD();
        }
    });

    // Kampf-Logic
    bullets.forEach((b, bi) => {
        b.x += b.vx; b.y += b.vy; b.el.style.left = b.x+'px'; b.el.style.top = b.y+'px';
        enemies.forEach((e, ei) => {
            if(Math.abs(b.x-parseInt(e.el.style.left))<50 && Math.abs(b.y-parseInt(e.el.style.top))<50) {
                e.el.remove(); enemies.splice(ei, 1); b.el.remove(); bullets.splice(bi, 1);
                sessionCoins += 3; spawnEnemy(); updateHUD();
            }
        });
    });

    if(currentMode === 'Coin-Farming' && Math.abs(x-440)<80 && Math.abs(y-240)<80) die();

    const p = document.getElementById('player');
    p.innerText = currentSkin; p.style.left = x+'px'; p.style.top = y+'px';
    p.style.width = pSize+'px'; p.style.height = pSize+'px'; p.style.fontSize = (pSize*0.8)+'px';
    
    if(currentMode === 'Klassik') { timeLeft -= 0.016; if(timeLeft <= 0) finishLevel(); updateHUD(); }
    requestAnimationFrame(loop);
}

function die() {
    if(currentMode === 'Hardcore' && gameTime < 5) sessionCoins = 0; // Kein Exploit-Geld
    lives--; updateHUD();
    if(lives <= 0) { isAlive = false; finishLevel(); }
    else { x = 480; y = 280; }
}

function finishLevel() {
    isAlive = false; bank += Math.floor(sessionCoins);
    localStorage.setItem('p_bank', bank);
    document.getElementById('finishCoins').innerText = sessionCoins;
    toggleMenu('completeMenu', true);
}

function updateHUD() {
    document.getElementById('bankDisplay').innerText = bank;
    document.getElementById('hud-lives').innerText = "‚ù§Ô∏è " + lives;
    document.getElementById('hud-coins').innerText = "ü™ô " + sessionCoins;
    document.getElementById('hud-mode').innerText = currentMode.toUpperCase();
    document.getElementById('hud-timer').innerText = (currentMode === 'Klassik') ? Math.ceil(timeLeft) + "s" : "";
}

window.onkeydown=(e)=>keys[e.code]=true;
window.onkeyup=(e)=>keys[e.code]=false;
window.onmousedown=(e)=>{
    if(currentMode === 'Kampf' && isAlive) {
        const rect = document.getElementById('welt').getBoundingClientRect();
        const b = document.createElement('div'); b.className = 'bullet';
        const sx = x+pSize/2, sy = y+pSize/2;
        const angle = Math.atan2((e.clientY-rect.top)-sy, (e.clientX-rect.left)-sx);
        b.style.left = sx+'px'; b.style.top = sy+'px';
        document.getElementById('welt').appendChild(b);
        bullets.push({el:b, x:sx, y:sy, vx:Math.cos(angle)*15, vy:Math.sin(angle)*15});
    }
};

const canvas = document.getElementById('bgCanvas'); const ctx = canvas.getContext('2d');
canvas.width = window.innerWidth; canvas.height = window.innerHeight;
let stars = Array(150).fill().map(() => ({x:Math.random()*canvas.width, y:Math.random()*canvas.height, s:Math.random()*4}));
function drawBg() {
    ctx.fillStyle="#000"; ctx.fillRect(0,0,canvas.width,canvas.height);
    ctx.fillStyle="#fff"; stars.forEach(s=>{ ctx.fillRect(s.x,s.y,s.s,s.s); s.y+=0.4; if(s.y>canvas.height) s.y=0; });
    requestAnimationFrame(drawBg);
}
drawBg();
document.getElementById('bankDisplay').innerText = bank;
</script>
</body>
</html>
